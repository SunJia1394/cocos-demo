{"version":3,"sources":["file:///Users/sunjia/project/cocos-test/cocos-demo/extensions/live2d_cubismsdk_cocoscreator/static/assets/Framework/CubismPartsInspector.ts"],"names":["_decorator","Component","ComponentExtensionMethods","CubismDisplayInfoPartName","CubismPartsInspector","ccclass","getParts","cubismModel","findCubismModel","console","error","partsSource","parts","Array","length","i","displayName","diPartName","getComponent","partName","id","nodeUuid","node","uuid","componentUuid","opacity"],"mappings":";;;;;;;;;;;;;;;;;;;;AAOSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;;AACdC,MAAAA,yB;;AACAC,MAAAA,yB;;;;;;AATP;AACA;AACA;AACA;AACA;AACA;;;;;yBAOqBC,oB,WADpBJ,UAAU,CAACK,OAAX,CAAmB,sBAAnB,C,gBAAD,MACqBD,oBADrB,SACkDH,SADlD,CAC4D;AAC1D;AACF;AACA;AACA;AACUK,QAAAA,QAAQ,GAA2B;AACzC,cAAMC,WAAW,GAAG;AAAA;AAAA,sEAA0BC,eAA1B,CAA0C,IAA1C,CAApB;;AACA,cAAID,WAAW,IAAI,IAAnB,EAAyB;AACvBE,YAAAA,OAAO,CAACC,KAAR,CAAc,0BAAd;AACA,mBAAO,IAAP;AACD;;AAED,cAAMC,WAAW,GAAGJ,WAAW,CAACK,KAAhC;;AACA,cAAID,WAAW,IAAI,IAAnB,EAAyB;AACvBF,YAAAA,OAAO,CAACC,KAAR,CAAc,4BAAd;AACA,mBAAO,IAAP;AACD;;AAED,cAAME,KAAK,GAAG,IAAIC,KAAJ,CAA4BF,WAAW,CAACG,MAAxC,CAAd;;AACA,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGJ,WAAW,CAACG,MAAhC,EAAwCC,CAAC,EAAzC,EAA6C;AAC3C,gBAAIC,WAA+B,SAAnC;AACA,gBAAMC,UAAU,GAAGN,WAAW,CAACI,CAAD,CAAX,CAAeG,YAAf;AAAA;AAAA,uEAAnB;;AACA,gBAAID,UAAU,IAAI,IAAlB,EAAwB;AACtBD,cAAAA,WAAW,GAAGC,UAAU,CAACD,WAAzB;;AACA,kBAAI,CAACA,WAAL,EAAkB;AAChBA,gBAAAA,WAAW,GAAGC,UAAU,CAACE,QAAzB;AACD;AACF;;AACD,gBAAI,CAACH,WAAL,EAAkB;AAChBA,cAAAA,WAAW,GAAGL,WAAW,CAACI,CAAD,CAAX,CAAeK,EAA7B;AACD;;AAEDR,YAAAA,KAAK,CAACG,CAAD,CAAL,GAAW;AACTM,cAAAA,QAAQ,EAAEV,WAAW,CAACI,CAAD,CAAX,CAAeO,IAAf,CAAoBC,IADrB;AAETC,cAAAA,aAAa,EAAEb,WAAW,CAACI,CAAD,CAAX,CAAeQ,IAFrB;AAGTH,cAAAA,EAAE,EAAET,WAAW,CAACI,CAAD,CAAX,CAAeK,EAHV;AAITK,cAAAA,OAAO,EAAEd,WAAW,CAACI,CAAD,CAAX,CAAeU,OAJf;AAKTT,cAAAA,WAAW,EAAEA;AALJ,aAAX;AAOD;;AACD,iBAAO;AAAET,YAAAA,WAAW,EAAEA,WAAW,CAACgB,IAA3B;AAAiCX,YAAAA,KAAK,EAAEA;AAAxC,WAAP;AACD;;AAzCyD,O","sourcesContent":["/**\r\n * Copyright(c) Live2D Inc. All rights reserved.\r\n *\r\n * Use of this source code is governed by the Live2D Open Software license\r\n * that can be found at https://www.live2d.com/eula/live2d-open-software-license-agreement_en.html.\r\n */\r\n\r\nimport { _decorator, Component } from 'cc';\r\nimport ComponentExtensionMethods from '../Core/ComponentExtensionMethods';\r\nimport CubismDisplayInfoPartName from './CubismDisplayInfoPartName';\r\n\r\n@_decorator.ccclass('CubismPartsInspector')\r\nexport default class CubismPartsInspector extends Component {\r\n  /**\r\n   * Editor(Inspector) で 情報を取得するための実装\r\n   * @returns\r\n   */\r\n  private getParts(): IGetPartsResult | null {\r\n    const cubismModel = ComponentExtensionMethods.findCubismModel(this);\r\n    if (cubismModel == null) {\r\n      console.error('Find CubismModel failed.');\r\n      return null;\r\n    }\r\n\r\n    const partsSource = cubismModel.parts;\r\n    if (partsSource == null) {\r\n      console.error('CubismModel.parts is null.');\r\n      return null;\r\n    }\r\n\r\n    const parts = new Array<ISerializedParts>(partsSource.length);\r\n    for (let i = 0; i < partsSource.length; i++) {\r\n      let displayName: string | undefined;\r\n      const diPartName = partsSource[i].getComponent(CubismDisplayInfoPartName);\r\n      if (diPartName != null) {\r\n        displayName = diPartName.displayName;\r\n        if (!displayName) {\r\n          displayName = diPartName.partName;\r\n        }\r\n      }\r\n      if (!displayName) {\r\n        displayName = partsSource[i].id;\r\n      }\r\n\r\n      parts[i] = {\r\n        nodeUuid: partsSource[i].node.uuid,\r\n        componentUuid: partsSource[i].uuid,\r\n        id: partsSource[i].id,\r\n        opacity: partsSource[i].opacity,\r\n        displayName: displayName,\r\n      };\r\n    }\r\n    return { cubismModel: cubismModel.uuid, parts: parts };\r\n  }\r\n}\r\n\r\nexport interface IGetPartsResult {\r\n  /** uuid */\r\n  cubismModel: string;\r\n  parts: ISerializedParts[];\r\n}\r\n\r\nexport interface ISerializedParts {\r\n  nodeUuid: string;\r\n  componentUuid: string;\r\n  id: string;\r\n  opacity: number;\r\n  displayName: string;\r\n}\r\n"]}